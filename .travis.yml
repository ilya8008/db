---
language: python
python:
  - '3.6'
install:
  - pip install ansible>=2.4.0 molecule apache-libcloud pycrypto
env:
  matrix:
    - GCE_CREDENTIALS_FILE="$(pwd)/credentials.json"
  global:
    - secure: lYiyYDdAWgWzdDRtv9WxfU/OmwEqWTnrgYtsJSRGevPO4FXpzbSSvDLMsUoiOcDDKeweIjW6JIQ3FiAUittuDzCO+5lmmjE2nEc0kQ+TYo9s5ageMprUs+720zsKVmhk8vj8XYrzAfVbkgb6rzZYAbpiJcJ/X3LypybVrNqK+g8wFg7W4l+tGC69rykE5NUImwl1r3O9dX1kMJFDbGaMcc8neKuGS2fKxmOB31kcTrnKfuFp7EDmY8K7qL54qjNz/c93u0wkd0kfBt4qYTsShwXUYwA3Pj/4Z82zPNrlX8qb3HoDJplcaXMYDebFQxrXXnWMdcwdsRN8+fQvPEtS0g6EUscbMJa4fRiOU7AH/uNFkxKv8n5Zw2agsVyUuKKgepo+XzUZ55Tl/pOEvrpsHh6mIkiZHNyW3MwfkUPWIYExsTtlc6OOhfuYxubc5izOHxPIjb7gd2sqVpm4o7CFSeY5erG4NL/JnK+5rj9iS/ihgGJpNDr88qBnXvYoOXBWufbOdRpVcCq4WMr4yEEqePI3rKVYbkYcbA17V6ARFaN0QyBxUQMWuQEWjVkdvL/iuF1l/qLeF0JLMnOl+THl+8sMVOmvDMKKuJS3CHm6V/K0khXQNz+aZQhe1jualMxkjT1tnXkEd2WDXfI1DQdaVdR7p3gPOzDij8dUS+sb0T0=
    - secure: ZY0Ilvl8cIcL4dSzWDOrlckmYR5AmYu1gtLpFaGxqVkBck/w1NqQVrnYUrVXFoXtGQtP2dkL34pXGT2HJTjX5tMCmJGvQHVd0tuQV1JoYiBwdiTLdOE881V5y+lUaw2YNUzCfNsDD3Az+sGZR9sDbTDy5JOH8lSj6WEllIZULunC9+yOMcePVyC9w0HGt+9KL7NTu4xGu8OIbjm5j+4SmCObOTGL+PZ8cXSxUtoXY4KccRRs+B3Rt4vqVwvs7Y44UdjlnDXCszX4qXluLxdTWNydmEVwqFcxhlb1iUNloC70ZU9MHHHZKmgZrVTPHCo5KYo71QU34oLnx8Mb5D0I9TMA/DSQo3hV3eUCtngyWkKvxl2Vsnb+eSwIQujt3+TTkr8KCnjThgpD5n0w7fdSyDIlim//S9EpbPWnR99OidMsOlRggGODAuwQmUxeQJ2XOh3JmTv+b1GG1NuqqQTgzfdqzPdwIojYxTps0gIGtYdS1oTvr47VyP0eCw/0Nj+oKDYi8FVga9BhVZh2juOgVtX0NPdBMrGa2VX5DlyGCIry5OHU6rQM4l+nsyr+SOQIQH8XBWJa1makB2Xib9kbfbXtZA3WuI/cN3uXsQn3XXhIhuuBDu1ePmpMzSbfnx8n7dR6/Nb0ptOKPm/3fHBxcny0UrUda3qG4xpdYFerQMs=
    - secure: bjs2obPoHfJscwQPkiomOP07w3hoqvClDlEcUEXlg+vutxRbh0JuDleG8EtEWVi5EmU7OFVF5Os7Bbpv7xqmH0TroHiemnCs7WTnuaoDUTVmZ8NUsk1uk0IdytJWidhWECI/vcqa5IEbVB3jpNX0HvoYPQE8BbF2rIa0jBwAs4mBGhCA8u1/EfsFQwHgDDUUSiG3zxSJYQMc/UhcZAXr27rTksTDQff7aUlOhrBkb8R/ENgMdIkvgWriTDZ/Q5QE+B1V+Z1atbRt924wKYhczY94jbLVD91H96otm3Fv+Y4xysTWUcky924wtyQHuSvTQ282wlo3qbO3ohDvmrpNW/vqFcqIcK6UGD8ZqG+idnxlS+hA0t4REdCIZ25mYxr3hcDPLVYzWRF7rvQ+Xo81JjWmsG0f8qr9mcyM3z8iEw11D8V6VPAz3zUPb6ZsUgi+cfsB/KeJ+mIg6fImj3XTw3a9zwA7ScoUWeVWa6xQbO6aWVm8XUpVs+SXJCW8P2SXTB7aL7ZuRpwYBlkm5xMd5pn/ygFM6rXrxNZdb4X3B6G61emN2qhmkDHTqMGokE0L8bH8hmIkcBROvUUUShg5qxytJrncheF/XjNMbSOsgsGDKFqYcs3Z3UV2YPm+0yC0cb9O8hbPR2sSPDtaQcDtZSqdHgDZtN6qe1b6h7mV74o=
    - secure: hSYnB8WrVHGwNslSfv24tsiFkw9n66tbmtIH98IEWM3DJMSHG8RCSjpPuF1RKvlN5977ktHAOAq7XIQ77UvdqjlUNAlZJS/PFgRjlkHIg5I9YoaHSIhFN9OvmGlqEWvoaukSw8/bf39tquhVr9AUQdcvblxQKvPdPqE91DS+INcHkPJKep2z+HfW8nBrahWDZ9he+tTYvLxMUMlFsFBG5Lwzq9Mm2oK8N/eB+UnYIKW++xqYfIk7IOygqdduWrLXbS4PeHE0PuJCH3cbKgtJ0Uq7Byh5SfI2wG0xIyT14sGWWOoojBphDZGNZXNQ99yD3V8kBJBHYEuXr3rGHz0tcECFQ8rgWcQSr334HZ8MN0Gvj68Quj7pSv6oJTpIAAvw69dFdKI07Syattajns/0/GCgmQhX/AssCspr/EVVrnxhtn4d9mnmcV3YvpXgWzNP5B1D793v2JyJQ5ySIx8qZX1isDoxpRr+Pj9vS/fajqEHozHJMneKLHYc4+zii+xwoFfhorAB3LBgthwl1MA8pr6NS/RhWnPbFJPkvn5Rzcw2JJQWu4tLHCXB6moFMWGGg60dtmIhsZwyOd2bPgP47EyFsX4Gt8oAra//vJ1PSai7CxnxNwmZ5xU7GF2He0hqdI4MxXc44kpsxITLiAm34NQr51R7i9WzdkN+YHj+Rss=
script:
  - molecule create
  - molecule converge
  - molecule verify
after_script:
  - molecule destroy
before_install:
  - openssl aes-256-cbc -K $encrypted_1509c37ab118_key -iv $encrypted_1509c37ab118_iv -in secrets.tar.enc -out secrets.tar -d
  - tar xvf secrets.tar
  - mv google_compute_engine /home/travis/.ssh/
  - chmod 0600 /home/travis/.ssh/google_compute_engine
notifications:
    slack: devops-team-otus:8Kii1ZfVdwPAiB0VzOqq41nA
